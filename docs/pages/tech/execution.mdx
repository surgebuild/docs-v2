---
title: Execution Layer
description: EVM compatible execution with reth + CometBFT, state-root–bound BTC spends
---

# ⚙️ Execution Layer
The **Execution Layer** acts as Surge’s universal ledger for Bitcoin backed liabilities. It connects Bitcoin vaults, signer rules, and stablecoin issuance into a deterministic state machine, ensuring that BTC collateral can only move when programmatic conditions are satisfied.

## Universal Ledger for BTC-Backed Liabilities
The Execution Layer maintains the **single source of truth** for:
- dVault collateral ratios.
- Active liabilities (stablecoin denominated debt).
- Signer sets and epoch rotations.

It **prevents rehypothecation** by ensuring every Bitcoin UTXO is represented exactly once in system state, binding liabilities directly to on-chain BTC collateral.

## Implementation Details
- **Execution Engine**: `reth` provides an EVM-compatible state machine for programmability.
- **Consensus**: `CometBFT` delivers deterministic ordering and block finality across validators.
- **State Objects**:
  - `VaultState { collateral, debt, CR, signerSet }`
  - `StabilityPoolState { deposits, liquidationEvents }`
  - `CrossChainState { CCTP_transfers, attestations }`

Each finalized block produces a **state root**, which becomes the binding reference for signer permissions and BTC spend conditions.

## Bitcoin Aware State
The Execution Layer is deeply coupled to Bitcoin:
- **Oracle Feeds**: Medianized BTC/USD prices from trusted providers update collateral ratios.
- **Bitcoin Attestations**: Proof-of-inclusion for UTXOs and Taproot spends are submitted to validators, ensuring the ledger mirrors real Bitcoin state.

This guarantees that liabilities in Surge are always tied to **native Bitcoin collateral**, never synthetic abstractions.

## State Commitments and Root Binding
Every block finalizes a **state root** that encodes:
- Active vault positions and CR.
- Signer set and epoch key.
- Stability Pool balances.
- Cross-chain stablecoin flows.

BTC spends from a dVault are only valid if the signer set co-signs under the **aggregate Lin22 Schnorr key** bound to this state root. This creates a cryptographic anchor: collateral cannot move unless the Execution Layer authorizes it.

## Oracle Integration
The Execution Layer embeds a native oracle service to track BTC/USD prices and enforce collateralization logic. Unlike external plug-ins, this oracle is treated as a core module of the Surge state machine.
- **Protocol-Native** - Oracle updates are produced and validated inside the Execution Layer, ensuring they are subject to the same consensus rules as all other state transitions.
- **Medianization Logic** - Each block finalizes a price point derived from multiple signed submissions, aggregated deterministically.
- **Validator Replication** - All validators replay the same oracle logic, guaranteeing consistent collateral ratio updates across the network.

### Oracle Role
- **Collateral Monitoring** - Updates VaultState with fresh BTC/USD ratios.
- **Liquidation Enforcement** - Emits LiquidationTriggered when CR < MinCR, binding signer permissions for liquidation spends.
- **System Integrity** - Ensures liabilities remain anchored to verifiable BTC market value, without relying on off-chain actors.

### Failure Safety
- **Deterministic Fallbacks** - If insufficient updates arrive, the system falls back to the last confirmed state until new values finalize.
- **Consensus Enforcement** - Price data becomes valid only once included in a finalized block, preventing manipulation or divergence across validators.

## Signer Enforcement
Signer participation is tightly controlled:
- **Lin22 Schnorr Signing**: Coinbase cb-mpc coordinates threshold Schnorr rounds for Taproot keys.
- **Contract-Gated Authorization**: Signers may only sign if the Execution Layer has emitted a valid event.
- **No Rogue Signing**: Signers do not decide when BTC can move - the ledger enforces it.

This guarantees **programmatic enforcement of BTC custody**, not human discretion.