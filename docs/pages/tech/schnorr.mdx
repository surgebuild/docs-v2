---
title: Threshold Schnorr Signatures (Lin22)
description: Distributed Schnorr signing for Taproot vault control.
---

# ðŸ‘¥ Threshold Schnorr Signatures (Lin22)

Surge implements **Lindell 2022 Multiparty Schnorr Signing** a threshold Schnorr signature protocol providing full simulatability and UC-level security. It enables distributed control of Taproot vaults (dVaults) without revealing the signer structure or compromising privacy.

## Why Threshold Schnorr Signatures Essential for dVaults

- **Taproot Compatibility** - Bitcoinâ€™s Taproot ([BIP340](https://en.bitcoin.it/wiki/BIP_0340)) requires Schnorr signatures. Threshold signatures must be indistinguishable from single-party Schnorr signatures to preserve privacy and efficiency.
- **Non-Custodial Control** - No individual signer can move BTC, only a threshold of signers can jointly authorize a transaction, preventing unilateral custody.
- **Threshold Signing** - Every signing session is gated by pre-sign policy checks; only a t-of-n quorum can authorize within rules.
- **Byzantine Resilient Operation** - Signers must remain operable even if some signers are malicious or offline. Abort detection and recovery prevent permanent capital lock-up.

## Lin22 vs. FROST

Two major threshold Schnorr constructions were evaluated:

- **FROST (RFC 9591)** - Optimized for speed (two rounds).
- **Lindell 2022 (Lin22)** - Optimized for robustness, with three rounds and formal UC proofs.

| Property | **FROST** | **Lin22 (2022)** |
|----------|-----------|------------------|
| **Signing Rounds** | 2 | 3 |
| **Security Proof** | **UC secure** (Universally Composable), but aborts if signers fail | **Full simulatability** with UC secure (Fischlin ZKPs) |
| **Abort Handling** | Halts if any signer malicious, relies on coordinator trust | Identifies cheaters with proof; removes signer for next set of request |
| **DKG Setup** | ~2 rounds (Pedersen VSS) | 5+ rounds (Feldman VSS, stronger consistency) |
| **Best Case** | Highly efficient when all honest | Robust to faults |
| **Output** | BIP340 Schnorr | BIP340 Schnorr |

## Why Surge Chooses Lin22

Surge prioritizes **liveness, accountability, and verifiability** over lowest latency.

- **Trustless Coordinator** - Unlike protocols that require trust assumptions on the coordinator or rely on non-standard assumptions like one-more discrete log or algebraic group models, Lin22 achieves security.
- **Identifiable Misbehavior** - Each signer provides Fischlin Zero-Knowledge Proofs (ZKPs). If a signer cheats or aborts, the network obtains cryptographic evidence, enabling automated slashing and signer rotation.  
- **Privacy Preserving** - The aggregated output remains a standard BIP340 Schnorr signature. Vault spends are indistinguishable from any regular Taproot spend.

Surgeâ€™s implementation uses Coinbaseâ€™s audited [**cb-mpc**](https://github.com/coinbase/cb-mpc) library, embedding Lin22 within the signer coordination service.

## Signing Flow in Surge (Lin22)

#### 1. Distributed Key Generation (DKG)
- Key shares are generated using **Feldmanâ€™s Verifiable Secret Sharing (VSS)**.
- Public commitments allow verification that shares are consistent.
- Result: A single Taproot public key with private shares held by signers.

#### 2. Signing Rounds

**Round 1 - Commitment**  
- Each signer selects a fresh random nonce and broadcasts a *hash commitment* to it.  
- Inclusion in this round is mandatory.

**Round 2 - Decommitment & Proof**  
- Signers reveal their nonces and provide **Fischlin Zero-Knowledge Proofs (ZKPs)**.  
- Invalid commitments, failed ZK proofs, or missing responses flag misbehavior.

**Round 3 - Signature Shares**  
- Honest signers compute signature shares using their secret key share and nonce.  
- Coordinator aggregates valid shares. 
- Verifies that (e, s) is a valid signature.
- Final output: A single **BIP340 Schnorr signature**, valid for Taproot.

## Example: 3 of 4 Signing

- **FROST** â†’ If a signer submits invalid data (e.g., a bad signature share), the session aborts. The honest participants cannot complete the signature. Need to trust coordinator to remove malicious signer.
- **Lin22** â†’ If a signer misbehaves, their ZK proof (included in the protocol) reveals them as malicious to the network. The session aborts, but with publicly verifiable evidence of who misbehaved. this will help for slashing and signature share rotation.

**dVault remains operable even under Byzantine conditions.**, ensuring both fault-tolerance and cryptographic accountability.

---

Surge adopts Lin22 Threshold Schnorr Signatures because resilience and verifiability matters more than speed when securing Bitcoin collateral at scale.

## External Reference
[Simple Three-Round Multiparty Schnorr Signing with Full Simulatability](https://eprint.iacr.org/2022/374.pdf)
[Cure53 Audit Report: Coinbase cb-mpc Library](https://github.com/coinbase/cb-mpc/blob/master/docs/cure53-audit.pdf)